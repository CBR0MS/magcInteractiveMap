{% extends 'base.html' %} 
{% block head_title %}Interactive Map{% endblock %}
{% block head %}
    <script type="text/javascript" src="https://cdn.rawgit.com/anvaka/panzoom/v4.4.0/dist/panzoom.min.js"></script>
    <style type="text/css" media="screen">
        body, html {
            position: fixed;
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }
        .zoomable {
            cursor: crosshair;
        }
        .click {
            border-radius: 50%;
            height: 50px;
            width: 50px;
            background-color: red;
            position: absolute;
            z-index: 100;
        }
    </style>
{% endblock %}

{% block content %}

    {% load helpers %}
    {% load static %}

    
    <div class='zoomable' >
        <div class="rotated" style="transform: rotate(-61deg);">
            <img src="{{ map.image.url }}" id="map">

        <!-- <canvas id="mapCanvas" 
            width="{{ map.image.width }}" 
            height="{{ map.image.height }}" 
            style="border:1px solid black; margin: 0 auto;">
        </canvas> -->
        <div id="clickElements">
            {% for point in points %}
               <a href="details/{{ point.id }}">
                    <div class="click" 
                         style="bottom:{{ point.y|add:"-25" }}px; left:{{ point.x|add:"-25" }}px"
                         title="{{ point.short_name }}">
                    </div>
                </a>
            {% endfor %}
        </div>
        </div>
    </div>
    <!--
    <a href="{% value_in_url 'dogs' request.GET.urlencode %}"><button type="button">Dogs</button></a>
<a href="{% value_in_url 'puckles' request.GET.urlencode %}"><button type="button">Puckles</button></a>

Selections: 
{% for tag in selections %}
    <p>{{ tag }}</p>
{% endfor %}
-->
{% endblock %}

{% block scripts%}
    <script type="text/javascript">
        let area = document.querySelector('.zoomable')
        panzoom(area);
        /*panzoom(area).zoomAbs(
                                -1100, // initial x position
                                -1500, // initial y position
                                0.5  // initial zoom 
                );*/
        let height = {{ map.image.height | js}};
        let width = {{ map.image.width | js}};
        let points = {{ points | js}};
    </script>
    <script type="text/javascript" src="{% static "map.js" %}"></script>
{% endblock %}
